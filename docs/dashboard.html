<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>דשבורד סטטיסטיקות</title>
  <link rel="stylesheet" href="assets/style.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<header>
  <div class="bar">
    <div>
      <div class="brand">📊 דשבורד סטטיסטיקות</div>
      <div class="badge">גישה רק למנהלים מורשים (Email/Password)</div>
    </div>
    <div class="actions" style="margin:0">
      <a href="index.html" style="text-decoration:none"><button>חזרה לטופס</button></a>
      <a href="reports.html" style="text-decoration:none"><button>רשומות 🗂️</button></a>
      <button class="primary" id="loginBtn">התחברות מנהל</button>
      <button class="danger hidden" id="logoutBtn">התנתקות</button>
    </div>
  </div>
</header>

<div class="container">

  <!-- ניווט מהיר (חדש) -->
  <div class="card">
    <h3>ניווט מהיר</h3>
    <div class="small">לצפייה בכל הביקורות והתרגילים בטבלה (כולל ציונים, הערות ותאריך) עבור מנהלים.</div>
    <div class="actions">
      <a href="reports.html" style="text-decoration:none"><button class="primary">פתח רשימת רשומות 🗂️</button></a>
    </div>
  </div>

  <!-- כרטיס התחברות מנהל -->
  <div class="card" id="loginCard">
    <h3>התחברות מנהל</h3>

    <label>אימייל</label>
    <input id="adminEmail" type="email" placeholder="name@example.com" autocomplete="username"/>

    <label>סיסמה</label>
    <input id="adminPass" type="password" placeholder="••••••••" autocomplete="current-password"/>

    <div class="actions">
      <button class="primary" id="loginBtnInline">התחברות</button>
      <button class="danger hidden" id="logoutBtnInline">התנתקות</button>
    </div>

    <div class="small" id="loginStatus">🔒 לא מחובר</div>
    <div class="small">* רק משתמשים שמופיעים ברשימת <b>admins</b> יראו סטטיסטיקות ורשומות.</div>
  </div>

  <div class="card">
    <h3>פילטרים כמותיים</h3>
    <div class="row">
      <div>
        <label>חתך לפי</label>
        <select id="groupBy">
          <option value="type">סוג</option>
          <option value="sector">גזרה</option>
          <option value="role">תפקיד</option>
          <option value="name">שם מבצע</option>
        </select>
      </div>
      <div>
        <label>סינון גזרה</label>
        <select id="sectorFilter">
          <option value="">הכל</option>
          <option value="אלון מורה">אלון מורה</option>
          <option value="איתמר">איתמר</option>
          <option value="ברכה">ברכה</option>
          <option value="לב השומרון">לב השומרון</option>
          <option value="אחר">אחר</option>
        </select>
      </div>
      <div>
        <label>טווח ימים אחורה</label>
        <select id="daysBack">
          <option value="7">7</option>
          <option value="30" selected>30</option>
          <option value="90">90</option>
          <option value="365">365</option>
        </select>
      </div>
    </div>
    <div class="actions">
      <button class="primary" id="loadBtn">טען סטטיסטיקות</button>
    </div>
    <div class="small" id="dashStatus"></div>
  </div>

  <div class="card">
    <h3>גרף</h3>
    <div style="height:260px">
      <canvas id="chart"></canvas>
    </div>
  </div>

  <div class="card">
    <h3>טבלת ספירות</h3>
    <pre id="table" style="white-space:pre-wrap"></pre>
  </div>
</div>

<script type="module">
  // סנכרון בין זוג כפתורי header לזוג הכפתורים בתוך הכרטיס
  const bind = (srcId, dstId) => {
    const src = document.getElementById(srcId);
    const dst = document.getElementById(dstId);
    if (src && dst) src.addEventListener("click", () => dst.click());
  };

  bind("loginBtn", "loginBtnInline");
  bind("logoutBtn", "logoutBtnInline");
</script>

<script type="module" src="js/dashboard.js"></script>
</body>
</html>
